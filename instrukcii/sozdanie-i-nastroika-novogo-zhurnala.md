# Создание и настройка нового журнала

1. В Конфигураторе \(Администраторе\) в разделе "Настройки" нужно выбрать или создать группу журналов.

Группа журналов - это узел настроек с произвольным названием \(часто "Journals group"\),

единственной отличительной особенностью которого является наличие системного свойства

`.Type=Journals group`

Для создания группы журналов ее можно скопировать из другой группы, или скопировать

в буфер обмена и вставить в Администратор следующий текстовый фрагмент:

```sql
[Journals group]
.Parent=NULL
.Caption=Journals group
.BasedOn=Journals group
.Type=Journals group
.ReplicAble=1
.IsGroup=1
```

2. В выбранной или созданной группе журналов создать новый узел журнала

Журнал - это узел настроек с несколькими обязательными и необязательными свойствами,

отличительной особенностью которого является наличие системного свойства

`.Journal=`

Для создания нового журнала его можно скопировать из другого журнала, или скопировать

в буфер обмена и вставить в Администратор следующий текстовый фрагмент:

```sql
[Materiale]
.Parent=Journals group
.Caption=Materiale
.Journal=
Caption=02.Материалы
.type.Caption=String
DocTypesFilter=
.type.DocTypesFilter=Memo
SQLFilter=
.type.SQLFilter=Memo
```

3. Настроить обязательные свойства узла нового журнала

Обязательными для журнала являются два свойства: "`DocTypesFilter`" и "`SQLFilter`"

Свойство "`DocTypesFilter`" задает фильтр на таблицу типов документов \(`SYSFID`\),

определяя список допустимых для добавления в описываемом журнале.

Синтаксис значения этого свойства поддерживает только самые простые конструкции.

Например, "`id=48115 or id=48116 or id=48132`" или "\(`id>=1201 and id<=1220 or id=604`\)"

Свойство "`SQLFilter`" задает фильтр на таблицу типов документов \(`SYSFID`\),

определяя список допустимых для просмотра в описываемом журнале.

Синтаксис значения этого свойства соответствует языку `SQL` используемого сервера.

Например, "`sysfid in (48115,48116,48132)`" или "\(`sysfid between 1201 and 1220 or sysfid=604`\)"

3. Настроить необязательные свойства узла нового журнала

Свойство "`Caption`" задает название пункта меню, соответствующего описываемому журналу.

\(При отстуствии или пустом значении этого свойства вместо него используется имя узла\)

Свойство "`DLL ID`" должно отсутствовать или содержать пустое или нулевое значение.

\(Ненулевые значения свойства "`DLL ID`" обрабатываются отдельным устаревшим алгоритмом\)

Свойство "`DLL JournalName`" может отсутствовать или содержать произвольное значение.

\(Оно обрабатывается только при ненулевом значении свойства "`DLL ID`"\)

Свойство "`DocTypesDefault`" задает `SYSFID` документа по умолчанию,

который автоматически выбирается при добавлении нового документа.

\(Когда свойство `DocTypesFilter` описывает один `SYSFID`, он и используется по умолчанию\)

Свойство "`SQLBody`" задает текст `SQL`-запроса, используемого для просмотра списка документов.

Здесь можно задать дополнительные вычисляемые поля, но в основе должен лежать запрос

`SELECT * FROM VMDB_DOCS`

 Например:

```sql
[ZZZ]
SQLBody=.MEMO.ZZZ.SQLBody
.type.SQLBody=Memo
[.MEMO.ZZZ.SQLBody]
select * from (SELECT D.*,
(select prfact_seria from VMDB01M_VINZ  WHERE cod=d.cod) seria,
(select prfact_nr from VMDB01M_VINZ  WHERE cod=d.cod) numarul,
(SELECT DENUMIREA FROM VMS_UNIVERS U, VMDB_ST201M M
 WHERE U.cod=NVL(M.CTDEP,m.Dtdep) AND M.NRDOC=D.COD) CLIENT,
(select prfact_data from VMDB01M_VINZ  WHERE cod=d.cod) datafact
FROM VMDB_DOCS D)
```

4. Настроить дизайн нового журнала

Для настройки переводов заголовков столбцов надо выбрать пункт

"Изменить заголовки" в контекстном меню грида списка документов.

Для сохранения переводов заголовков столбцов при сохранении дизайна

надо в окне настройки дизайна нажать кнопку "`Grid`" и включить галку

"`Save grid properties`".

