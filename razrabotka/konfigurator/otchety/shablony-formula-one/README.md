# Шаблоны Formula One

[Page Break](page-break.md) \(переход на новую страницу\)

[F1PageHeader и Footer](f1pageheader-i-footer.md)

[Колонтитулы](kolontituly.md)

[Опции в шаблонах Formula One](opcii-v-shablonakh-formula-one.md)

[Формат ячеек Formula One](format-yacheek-formula-one.md)

[Цвет отдельных ячеек](cvet-otdelnykh-yacheek.md)

Параметры/управляющие конструкции находятся в первых трех столбцах. Примеры:

params setrowheightauto off

params supressblanklines off

params usecellcolor on

params userowcolor off

title

detail1

groupF \_clcpos\_codt

summary

params JoinFields

Полезности:

Конкатенация строк: =\_codU&" - "&\_Denumirea

ReturnRefresh=1 =&gt; если в печатной форме настроен прыжок из нее в какой-то, например, документ, а после выхода из документа нам надо снова венуться в уже прорефрешенную печатную форму, из которой все и начиналось, то в шаблоне печатной формы, наряду с настройками прыжка \(см."help по прыжкам.doc"\), нужно добавить это свойство.

если в 3й колонке для groupH пишется pagebreak nogeader, тогда эта строка будет всегда начинаться с нового листа/страницы

Если в каких-то строках есть title page, то на каждой новой странице эти строки будут печататься

если получается вставить картинку, то надо при сохранении выбрать другой тип formula one \(поэкспериментировать\)

usewhen\(part=4\) usewhen\(tip=1\) если сочетание условий, может фтв тоже работает

title general

summary

grouph

groupf

detail1

detail2 names

titlespec1

tip

PIVOT

\_

// Не найдено ни '\_', ни '\[', ни ссылки на ячейку

params

nocopyformat OFF

SETROWHEIGHTAUTO\) ON

SETCOLWIDTHAUTO\)

SUPRESSBLANKLINES\)

NOCOPYROWFORMAT\)

PRESERVESYSCOLS\)

USEROWCOLOR\)

USEROWCOLOR\)

SMARTDATE\)

JOINVALUES\) Объединение повторяющейся аналитики

JOINENFORCED\) Принудительное объединение

JOINFIELDS\) Список полей аналитики

SHOWZEROVALUES\) Отображение значений "0"

usewhen

usewith

// AParams содержит имя поля и \(необязательно\) его значение, отделенное

// разделителем, обозначающим тип условия: равенство или неравенство.

// Разделители ',' '=' и '==' обозначают условие на равенство,

// разделители '!' '!=' и '&lt;&gt;' обозначают условие на неравенство.

// Если ни один из перечисленных разделителей не найден в строке AParams,

// вся строка считается именем поля, а условие - условием на равенство 1.

// В любом случае поле и его значение считаются ЦЕЛОЧИСЛЕННЫМИ \(ftInteger\)

//---------------------------------------------------------------------------

"// Функция находит в оставшейся части строки выражения типа ссылки на ячейку

// Поддерживается относительная и абсолютная адресация \(A1, B$2, $C4, $D$6\)

// Поддерживаются интервалы типа C2:E8 \(как две разные ссылки\)

// ""Бесконечные"" интервалы \(типа C:E, 3:5\) ПОКА не поддерживаются

// nPos1 и nPos2 - позиции найденных слов \(после них нет смысла искать\)

//---------------------------------------------------------------------------

static int \_\_fastcall FindRef\(AnsiString& AText, int APos, int APos1, int APos2\)

"

