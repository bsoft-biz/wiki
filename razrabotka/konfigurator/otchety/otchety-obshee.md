# Отчеты \(общее\)

Объекты типа Отчеты содержат настройки соответствующих отчетов. Дерево отчетов отображается в окне \[Raport manager\] приложения Universal Accounting. Иерархия дерева отчетов текущей записи настроек – это логическая организация списка отчетов по их назначению. Число уровней вложенности узлов, служащих для логической группировки объектов, не ограничено

Пример дерева отчетов

* Rapoarte materiale/materia prima \(Материальные отчеты\)
* Rapoarte universale \(Универсальные отчеты\)
* Rapoarte vinzari \(Отчеты Продажи\)
* Rapoarte active fixe \(Отчеты Основные фонды\)
* Achizitii \(Поступления\)
* Rapoarte livrari \(Отчеты Отгрузка\)
* Rapoarte financiare \(Финансовые отчеты\)
* Decontari cu clientela \(GCC\) \(Расчеты с клиентами\)
  * Rapoarte CASA \(Отчеты Касса\)
    * Anexa CASA Total pe conturi \(Приложение Касса Итого по счетам\)
      * Descifrarea din credetul 2411 \(Расшифровка кредита счета 2411\)
    * Descifrarea din debetul 2411 \(Расшифровка дебета счета 2411\)
    * Darea de seama a casierului \(Отчет кассира\)
    * Foaie suplimentara la Registrul de Casa \(Дополнение к отчету кассира\)
    * Jurnal-Order Nr1 \(Журнал-ордер N 1\)
* Contracte \(Контракты\)
* Materiale \(Материалы\)

`Большинство отчетов поддерживают следующие свойства (свойства группы Общая)`

| **Имя свойства** | **Назначение** |
| :--- | :---: |
| DLL ID | Идентификационный номер DLL |
| Index Fields |  |
| Master Fields |  |
| Report ID | Идентификатор печатной формы в DLL |
| Report Type | Типы отчетов: FormulaOne, ExcelGL2, FastReport,MSWord |
| SQLDetail SQL | Запрос, возвращающий данные в область Detail \(область данных подчиненной таблицы\) печатной формы |
| SQLHeader SQL | Запрос, возвращающий данные в область Header \(область заголовка\) печатной формы |
| SQLMaster | Запрос, возвращающий данные в область Master \(область данных главной таблицы\) печатной формы |
| Template | Шаблон, используемый для генерации печатной формы |
| WindowCaption | Подпись окна сгенерированной печатной формы |

Некоторые отчеты поддерживают специфические свойства

Новые отчеты создаются и настраиваются преимущественно на базе т н Универсального отчета \(DLL ID = 2, Report ID = 1\), Нового Универсального отчета \(DLL ID = 4201, Report ID = 12\) и Отчета с произвольными параметрами \(DLL ID = 9002, ReportID = univ\)

* **Универсальный отчет \(Регистр оборотов и остатков\)**

`Свойства Универсального отчета`

| **Имя свойства** | **Назначение** |
| :--- | :---: |
| DLL ID | Идентификационный номер DLL \(Значение 2\) |
| Caption | Подпись окна параметров отчета |
| Report ID | Идентификационный номер отчета в DLL \(Значение 1\) |
| Fields List A | Список полей, доступных в разделе \[Parametrii principali\]Формат списка:Имя поля \(под которым оно появляется в списке\) в кавычках,Имя поля \(имя поля в результирующем наборе записей и в шаблоне отчета\) |
| Fields List B | Список полей, доступных в разделе \[Corespondenta\] |
| Report Type | Один из трех типов отчетов: Formula One, ExcelGL2, FastReport. Отчеты на базе Универсального отчета обычно имеют тип Formula One. |
| Schema | Текст, содержащий настройки окна параметров отчета: отображение / скрытие элементов управления, установка значений по умолчанию, список выбранных полей, включение / выключение флажковФормат:\[Имя элемента управления\].Visible=0,1\(0 – скрытие элемента управления, 1 –отображение элемента управления\)\[Имя элемента управления\].Text= \(Значение по умолчанию для элемента управления\)Список полей, выбранных в разделе \[Parametrii principali\] \(\[Corespondenta\]\)FieldListA – start \(FieldListB – start\)Имя поля \(под которым оно появляется в списке\) в кавычках,Имя поля \(имя поля в результирующем наборе записей и в шаблоне отчета\)FieldListA – end    \(FieldListB – end\) |

Пример значения свойства Schema:

_fl001acc.Visible=1_

_fl001acc.Tag=0_

_fl001acc.Text=211 213 921 217_

_fl001dep.Visible=1_

_fl001dep.Tag=1098_

_fl001dep.Text=1098,Depozit de materiale chimice, fire si deseuri_

_FieldListA - start_

_a.Cont,CONT_

_b.Cont.sc.,CONT1_

_"d.Cont analitic - cifru",SCCODE_

_"f.Cont analitic - denumirea 2",SCNAME2_

_"e.Cont analitic - denumirea",SCNAME_

_"g.Cont analitic - unitatea de masura",SCUM_

_"c.Cont analitic - cod",SC_

_ListC.Text="a. Sold init Dt","c. Rulajul Dt","d. Rulajul Ct","e. Sold final Dt"_

Замечание

Схему окна параметров отчета из приложения Universal Accounting можно позволяет получить контекстное меню \[Vizualizarea parametrelor pentru Schema curenta\] окна параметров отчета.

| Template | Шаблон, используемый для генерации отчета |
| --- |


* **Новый универсальный отчет**

`Свойства Нового Универсального отчета`

| **Имя свойства** | **Назначение** |
| :--- | :---: |
| Caption | Подпись окна параметров отчета |
| DLL ID | Идентификационный номер DLL \(Значение 4201\) |
| Report ID | Идентификационный номер отчета в DLL |
| Report Type | Один из трех типов отчетов: Formula One, ExcelGL2, FastReport |
| OraFunction | Процедура PL/SQL генерации результирующего набора записей |
| RseFiledsBaza | Список доступных и выбранных полей раздела Filtru de baza |
|  | Список доступных и выбранных полей раздела Filtru Corespondent |
| RseSoldRulajTmplOrder | Указывает, какие из категорий Sold Initial Dt, Ct, Rulaj Dt, Ct, Sold Final Dt, Ct используются в отчете и порядок появления их в шаблоне |
| RseSumaCantTmplOrder | Указывает, какие из категорий Cant, Suma, SumaVal используются в отчете и порядок появления их в шаблоне |
| RepWindow | Текст, содержащий настройки окна параметров отчета: отображение / скрытие элементов управления, установка значений по умолчанию, включение / выключение флажков |
| Template | Шаблон, используемый для генерации отчета |

Примечание. Для справки по Новому Универсальному отчету см. RSE.DOC

* **Отчет с произвольными параметрами**

Отчет \(DLL ID = 9002, ReportID = univ \) поддерживает возможности настройки окна параметров отчета и указания наборов данных, выводящихся в отчете.

`Свойства отчета`

| **Имя свойства** | **Назначение** |
| :--- | :---: |
| Группа Filters:Filt1A, Filt2A, …, Filt6A | Установка фильтра по полю ‘Тип’ для записей универсального справочника, выводящихся в списках Filt1, Filt2, …, Filt6 |
| ПримерFlit1A = O \(Организации\)Filt2A = P \(Продукция\) |  |
| Группа Видимость:Filt1Visible, Filt2Visible, …, Filt6Visible, Parameter1Visible, …, Parameter4Visible | Отображение / скрытие элементов управления в окне параметров отчета |
| Группа Заголовки:Filt1Caption, Filt2caption, …,Filt6Caption, Parameter1Caption,…, Parameter4Caption | Создание подписей для элементов управления окна параметров |
| Группа Значения:Filt1Text, Filt2Text, …, Filt6Text, Parameter1Text, …, Parameter4Text | Установка значений по умолчанию для элементов управления окна параметров |
| Admin | Если значение True, выводит Админ. панель в окне параметров для доступа к конструктору формы параметров |
| DLL ID | Идентификационный номер DLL \(Значение 9002\) |
| Report ID | Идентификатор отчета в DLL \(Значение ‘univ’\) |
| ExtRep | Тип расширения файла шаблона \(0-xls,1-vts\) |
| MacroAfterBuild | Макрос Visual Basic для xls-отчетов |
| PeriodGlobal | Указывает, выводится ли период в окне параметров |
| Tip | Тип отчета: Только Master / Master–Detail |
| SQLHeader | Запрос, возвращающий данные в область Detail \(область данных подчиненной таблицы\) отчета |
| SQLMaster | Запрос, возвращающий данные в область Master \(область данных главной таблицы\) отчета |
| SQLDetail | Запрос, возвращающий данные в область Header \(область заголовка\) отчета |

* **TXT-свойства**

`TXT-свойства – свойства отчета в текстовом формате. Свойства поддерживаются всеми отчетами.`

| **Имя свойства** | **Назначение** |
| :--- | :---: |
| TXTFixedPreview | Автоматически выводит отчет и в текстовом формате наряду с основным \(Formula One Excel\) |
| TXT\_AutoCloseF1 | Выводит отчет только в текстовом формате |
| TXT\_AutoCloseTXT | Автоматически закрывает окно отчета в текстовом формате |
| TXT\_AutoPrint | Автоматически запускает печать отчета в текстовом формате |
| TXT\_HorzSize | Устанавливает число строк одной страницы текстового отчета |
| TXT\_Rulon | Использует рулон для печати текстового отчета, не разбивая отчет по страницам |
| TXT\_ShowBorders | Устанавливает режим вывода границ ячеек исходного шаблона в текстовом отчете:0 – не отображает границы1 – отображает все границы, за исключением точечных2 – отображает все границы |
| TXTVertSize | Устанавливает число столбцов одной страницы текстового отчета |

